# 15-文件结构完整索引

## 1. 项目根目录结构

```
chips-editor/
├── src/                        # 源代码
├── plugins/                    # 外部插件(可选)
├── public/                     # 公共资源
├── tests/                      # 测试
├── docs/                       # 文档
├── scripts/                    # 脚本
├── dist/                       # 构建输出(生成)
├── node_modules/               # 依赖(生成)
├── package.json                # 项目配置
├── tsconfig.json               # TypeScript配置
├── webpack.config.js           # Webpack配置
├── vite.config.ts              # Vite配置
├── .eslintrc.js                # ESLint配置
├── .prettierrc                 # Prettier配置
├── .gitignore                  # Git忽略文件
└── README.md                   # 项目说明
```

---

## 2. 源代码结构 (src/)

```
src/
├── engine/                     # 编辑引擎核心
│   ├── EditorEngine.ts        # 主引擎类
│   ├── LayoutManager.ts       # 布局管理器
│   ├── WindowManager.ts       # 窗口管理器
│   ├── FileManager.ts         # 文件管理器
│   ├── DragDropHandler.ts     # 拖拽处理器
│   ├── SaveManager.ts         # 保存管理器
│   ├── EventBus.ts            # 事件总线
│   └── index.ts               # 模块导出
│
├── kernel/                     # 内核
│   ├── Kernel.ts              # 内核接口
│   ├── PluginLoader.ts        # 插件加载器
│   ├── FileRecognizer.ts      # 文件识别器
│   └── index.ts
│
├── layouts/                    # 布局插件
│   ├── infinite-canvas/       # 无限画布布局
│   │   ├── InfiniteCanvasLayout.tsx
│   │   ├── DesktopLayer.tsx
│   │   ├── WindowLayer.tsx
│   │   ├── ZoomController.tsx
│   │   ├── components/
│   │   │   ├── CardWindow.tsx
│   │   │   ├── ToolWindow.tsx
│   │   │   ├── Dock.tsx
│   │   │   └── ZoomSlider.tsx
│   │   ├── styles/
│   │   │   └── infinite-canvas.css
│   │   └── manifest.json
│   │
│   └── workbench/             # 工作台布局
│       ├── WorkbenchLayout.tsx
│       ├── Sidebar.tsx
│       ├── PreviewArea.tsx
│       ├── EditPanel.tsx
│       ├── components/
│       │   ├── FileTree.tsx
│       │   ├── TabBar.tsx
│       │   └── Splitter.tsx
│       ├── styles/
│       │   └── workbench.css
│       └── manifest.json
│
├── plugins/                    # 其他插件
│   ├── editors/               # 编辑组件插件
│   │   ├── rich-text/
│   │   │   ├── RichTextEditor.tsx
│   │   │   └── manifest.json
│   │   ├── markdown/
│   │   │   ├── MarkdownEditor.tsx
│   │   │   └── manifest.json
│   │   └── image/
│   │       ├── ImageEditor.tsx
│   │       └── manifest.json
│   │
│   ├── renderers/             # 渲染器插件
│   │   ├── rich-text/
│   │   │   ├── RichTextRenderer.tsx
│   │   │   └── manifest.json
│   │   └── markdown/
│   │       ├── MarkdownRenderer.tsx
│   │       └── manifest.json
│   │
│   └── themes/                # 主题插件
│       ├── default/
│       │   ├── theme.css
│       │   └── manifest.json
│       └── dark/
│           ├── theme.css
│           └── manifest.json
│
├── ui/                        # UI组件
│   ├── components/            # 通用组件
│   │   ├── Button.tsx
│   │   ├── Input.tsx
│   │   ├── Dialog.tsx
│   │   ├── Toast.tsx
│   │   ├── ContextMenu.tsx
│   │   └── index.ts
│   │
│   ├── layouts/               # 布局组件
│   │   ├── Flex.tsx
│   │   ├── Grid.tsx
│   │   └── index.ts
│   │
│   ├── styles/                # 全局样式
│   │   ├── variables.css      # CSS变量
│   │   ├── reset.css          # 样式重置
│   │   ├── global.css         # 全局样式
│   │   └── themes/            # 主题
│   │       ├── light.css
│   │       └── dark.css
│   │
│   └── utils/                 # UI工具
│       ├── hooks.ts           # React Hooks
│       ├── animations.ts      # 动画工具
│       └── index.ts
│
├── types/                     # 类型定义
│   ├── engine.ts              # 引擎相关类型
│   ├── kernel.ts              # 内核相关类型
│   ├── plugins.ts             # 插件相关类型
│   ├── window.ts              # 窗口相关类型
│   ├── file.ts                # 文件相关类型
│   ├── events.ts              # 事件相关类型
│   └── index.ts               # 类型导出
│
├── utils/                     # 工具函数
│   ├── id.ts                  # ID生成
│   ├── file.ts                # 文件操作工具
│   ├── dom.ts                 # DOM操作工具
│   ├── date.ts                # 日期工具
│   ├── string.ts              # 字符串工具
│   ├── debounce.ts            # 防抖
│   ├── throttle.ts            # 节流
│   ├── logger.ts              # 日志工具
│   └── index.ts               # 工具导出
│
├── store/                     # 状态管理
│   ├── editorStore.ts         # 编辑器Store
│   ├── windowStore.ts         # 窗口Store
│   ├── fileStore.ts           # 文件Store
│   └── index.ts
│
└── index.ts                   # 入口文件
```

---

## 3. 测试目录结构 (tests/)

```
tests/
├── unit/                      # 单元测试
│   ├── engine/
│   │   ├── LayoutManager.test.ts
│   │   ├── WindowManager.test.ts
│   │   ├── FileManager.test.ts
│   │   ├── DragDropHandler.test.ts
│   │   ├── SaveManager.test.ts
│   │   └── EventBus.test.ts
│   │
│   ├── utils/
│   │   ├── id.test.ts
│   │   ├── debounce.test.ts
│   │   └── throttle.test.ts
│   │
│   └── store/
│       └── editorStore.test.ts
│
├── component/                 # 组件测试
│   ├── CardWindow.test.tsx
│   ├── ToolWindow.test.tsx
│   ├── Button.test.tsx
│   └── Dialog.test.tsx
│
├── integration/               # 集成测试
│   ├── layout-switching.test.ts
│   ├── file-operations.test.ts
│   ├── drag-drop.test.ts
│   └── window-management.test.ts
│
├── e2e/                       # 端到端测试
│   ├── create-card.spec.ts
│   ├── edit-card.spec.ts
│   ├── switch-layout.spec.ts
│   └── save-file.spec.ts
│
├── fixtures/                  # 测试固件
│   ├── files/
│   │   ├── test-card.cchips
│   │   └── test-box.cbox
│   └── data/
│       └── sample-data.json
│
└── setup.ts                   # 测试配置
```

---

## 4. 公共资源 (public/)

```
public/
├── index.html                 # HTML模板
├── favicon.ico                # 网站图标
├── assets/                    # 静态资源
│   ├── images/
│   │   ├── logo.svg
│   │   └── icons/
│   ├── fonts/
│   └── videos/
└── manifest.json              # Web App Manifest
```

---

## 5. 配置文件

### 5.1 package.json

```json
{
  "name": "chips-editor",
  "version": "1.0.0",
  "description": "Chips Card Editor Engine",
  "main": "dist/index.js",
  "types": "dist/index.d.ts",
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "preview": "vite preview",
    "test": "vitest",
    "test:unit": "vitest run --dir tests/unit",
    "test:component": "vitest run --dir tests/component",
    "test:integration": "vitest run --dir tests/integration",
    "test:e2e": "playwright test",
    "test:coverage": "vitest run --coverage",
    "lint": "eslint src --ext .ts,.tsx",
    "lint:fix": "eslint src --ext .ts,.tsx --fix",
    "type-check": "tsc --noEmit",
    "format": "prettier --write \"src/**/*.{ts,tsx}\""
  }
}
```

### 5.2 tsconfig.json

```json
{
  "compilerOptions": {
    "target": "ES2020",
    "lib": ["ES2020", "DOM", "DOM.Iterable"],
    "module": "ESNext",
    "jsx": "react-jsx",
    "declaration": true,
    "declarationMap": true,
    "sourceMap": true,
    "outDir": "./dist",
    "rootDir": "./src",
    "strict": true,
    "esModuleInterop": true,
    "skipLibCheck": true,
    "forceConsistentCasingInFileNames": true,
    "moduleResolution": "node",
    "resolveJsonModule": true,
    "allowSyntheticDefaultImports": true,
    "baseUrl": ".",
    "paths": {
      "@/*": ["src/*"],
      "@engine/*": ["src/engine/*"],
      "@ui/*": ["src/ui/*"],
      "@types/*": ["src/types/*"],
      "@utils/*": ["src/utils/*"]
    }
  },
  "include": ["src/**/*"],
  "exclude": ["node_modules", "dist", "tests"]
}
```

### 5.3 vite.config.ts

```typescript
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';
import path from 'path';

export default defineConfig({
  plugins: [react()],
  resolve: {
    alias: {
      '@': path.resolve(__dirname, 'src'),
      '@engine': path.resolve(__dirname, 'src/engine'),
      '@ui': path.resolve(__dirname, 'src/ui'),
      '@types': path.resolve(__dirname, 'src/types'),
      '@utils': path.resolve(__dirname, 'src/utils'),
    },
  },
  build: {
    lib: {
      entry: path.resolve(__dirname, 'src/index.ts'),
      name: 'ChipsEditor',
      fileName: (format) => `chips-editor.${format}.js`,
    },
    rollupOptions: {
      external: ['react', 'react-dom'],
      output: {
        globals: {
          react: 'React',
          'react-dom': 'ReactDOM',
        },
      },
    },
  },
});
```

---

## 6. 构建输出 (dist/)

```
dist/
├── index.js                   # UMD格式
├── index.es.js                # ES Module格式
├── index.d.ts                 # TypeScript类型定义
├── assets/                    # 静态资源
│   ├── index.css             # 样式
│   └── ...
└── types/                     # 类型定义
    └── ...
```

---

## 7. 文档目录 (docs/)

```
docs/
├── api/                       # API文档
│   ├── EditorEngine.md
│   ├── WindowManager.md
│   └── ...
│
├── guides/                    # 开发指南
│   ├── getting-started.md
│   ├── layout-development.md
│   ├── plugin-development.md
│   └── best-practices.md
│
├── examples/                  # 示例和教程
│   ├── basic-usage.md
│   ├── custom-layout.md
│   └── custom-plugin.md
│
└── architecture/              # 架构文档
    ├── overview.md
    └── data-flow.md
```

---

## 8. 文件大小估算

| 目录/文件 | 文件数 | 代码行数 | 说明 |
|-----------|--------|----------|------|
| `src/engine/` | 7 | ~1500 | 引擎核心 |
| `src/layouts/` | 20 | ~3000 | 布局插件 |
| `src/ui/` | 15 | ~1500 | UI组件 |
| `src/types/` | 7 | ~600 | 类型定义 |
| `src/utils/` | 9 | ~500 | 工具函数 |
| `src/store/` | 4 | ~400 | 状态管理 |
| **总计** | **62** | **~7500** | |

---

## 9. 模块依赖关系

```
index.ts (入口)
  │
  ├─> engine/ (编辑引擎)
  │    ├─> LayoutManager
  │    ├─> WindowManager
  │    ├─> FileManager
  │    ├─> DragDropHandler
  │    ├─> SaveManager
  │    └─> EventBus
  │
  ├─> layouts/ (布局插件)
  │    ├─> infinite-canvas/
  │    └─> workbench/
  │
  ├─> ui/ (UI组件)
  │    ├─> components/
  │    ├─> layouts/
  │    └─> styles/
  │
  ├─> store/ (状态管理)
  │
  ├─> types/ (类型定义)
  │
  └─> utils/ (工具函数)
```

---

完整的文件结构索引为开发者提供了清晰的项目组织结构,便于理解和导航代码库。
