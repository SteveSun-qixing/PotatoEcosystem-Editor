# Phase7 - 卡箱库

**周期**: 1 周  
**优先级**: 🟡 高  
**依赖**: Phase4, Phase6  
**状态**: 待开发

---

## 1. 阶段目标

实现编辑器的卡箱库组件：
- 显示所有可用的基础卡片类型（26种）
- 显示所有可用的箱子布局类型（8种）
- 支持拖放到画布创建卡片/箱子
- 搜索和分类过滤

---

## 2. 任务列表

### 2.1 创建卡箱库主组件

**任务 ID**: P7-T01  
**优先级**: 🔴 最高  
**预计工时**: 3h

**功能说明**:
- 网格列表显示卡片类型和箱子布局
- 标签页切换（卡片/箱子）
- 工具窗口形式

**核心代码结构**:
```vue
<!-- src/components/card-box-library/CardBoxLibrary.vue -->
<template>
  <ToolWindow title="卡箱库" icon="📦">
    <Tabs v-model="activeTab">
      <TabPane label="卡片" name="cards">
        <CardTypeGrid :types="cardTypes" @drag-start="handleDragStart" />
      </TabPane>
      <TabPane label="箱子" name="boxes">
        <LayoutTypeGrid :layouts="layoutTypes" @drag-start="handleDragStart" />
      </TabPane>
    </Tabs>
  </ToolWindow>
</template>
```

**验收标准**:
- [ ] 卡箱库显示正常
- [ ] 标签页切换正常
- [ ] 列表项显示正确

---

### 2.2 创建卡片类型网格

**任务 ID**: P7-T02  
**优先级**: 🔴 最高  
**预计工时**: 3h

**功能说明**:
- 显示 26 种基础卡片类型
- 分类显示（文本类、媒体类、交互类等）
- 每项显示图标、名称、描述
- 支持拖放

**卡片类型分类**:
- 文本类：富文本、Markdown、代码块
- 媒体类：图片、视频、音乐、3D模型
- 交互类：列表、打分、网页、游戏、应用
- 专业类：日历、甘特图、热力图、思维导图等
- 内容类：剧集、图文、帖子、聊天记录
- 信息类：名片、商品、设备

**验收标准**:
- [ ] 所有卡片类型显示
- [ ] 分类正确
- [ ] 拖放正常

---

### 2.3 创建布局类型网格

**任务 ID**: P7-T03  
**优先级**: 🟡 高  
**预计工时**: 2h

**功能说明**:
- 显示 8 种箱子布局类型
- 每项显示图标、名称、描述
- 支持拖放

**布局类型**:
- 基础布局：列表、网格、瀑布流、无限桌面
- 专业布局：时间线、书架、个人主页、朋友圈

**验收标准**:
- [ ] 所有布局类型显示
- [ ] 拖放正常

---

### 2.4 实现拖放创建功能

**任务 ID**: P7-T04  
**优先级**: 🔴 最高  
**预计工时**: 4h

**功能说明**:
- 从卡箱库拖动到桌面空白区域，创建新卡片/箱子
- 从卡箱库拖动到已有卡片，添加基础卡片
- 拖放过程中显示预览
- 释放时创建并打开窗口

**核心逻辑**:
```typescript
// 处理拖放结束
async function handleDrop(e: DragEvent, cardType: string) {
  const position = canvas.screenToWorld(e.clientX, e.clientY);
  
  // 创建卡片
  const card = await editor.createCard({ name: '新卡片', type: cardType });
  
  // 创建窗口
  windowManager.createCardWindow(card.id, { position });
}
```

**验收标准**:
- [ ] 拖放到空白区域创建正常
- [ ] 拖放到已有卡片添加正常
- [ ] 预览显示正常

---

### 2.5 实现搜索过滤

**任务 ID**: P7-T05  
**优先级**: 🟢 中  
**预计工时**: 1h

**功能说明**:
- 搜索框过滤卡片/布局类型
- 支持按名称、描述搜索

**验收标准**:
- [ ] 搜索功能正常

---

### 2.6 编写单元测试

**任务 ID**: P7-T06  
**优先级**: 🟡 高  
**预计工时**: 2h

**验收标准**:
- [ ] 测试覆盖率 >= 80%
- [ ] 所有测试通过

---

### 2.7 提交代码

**任务 ID**: P7-T07  
**优先级**: 🔴 最高  
**预计工时**: 0.5h

**验收标准**:
- [ ] 代码提交完成

---

## 3. 完成标准

- [ ] CardBoxLibrary 主组件完成
- [ ] CardTypeGrid 组件完成
- [ ] LayoutTypeGrid 组件完成
- [ ] 拖放创建功能完成
- [ ] 搜索过滤完成
- [ ] 单元测试覆盖率 >= 80%
- [ ] 代码提交完成

---

**任务分配**: 子代理-04（可与 Phase8 并行）  
**开始时间**: 待定  
**完成时间**: 待定
